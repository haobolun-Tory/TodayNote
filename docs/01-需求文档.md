# TodayNote 博客系统（MVP）需求文档

## 1. 背景与目标
TodayNote 是一个“尽量简单”的博客网站，参考博客园/简书的核心体验：
- 用户可以注册登录、写文章、发布与管理文章
- 访客可以浏览文章列表与详情
- 支持基础的分类/标签与搜索

目标：先实现可上线的最小闭环（MVP），在此基础上可逐步扩展。

## 2. 术语
- **文章**：用户发布的内容，包含标题、摘要、正文（Markdown）、封面（可选）等。
- **草稿**：未公开的文章，仅作者可见。
- **发布**：公开可访问的文章。
- **分类**：文章所属的大类（可选）。
- **标签**：文章的关键词集合（可选，多对多）。

## 3. 用户角色与权限
- **访客（未登录）**：浏览公开文章、搜索、查看作者主页。
- **普通用户（已登录）**：创建/编辑/发布/删除自己的文章，管理个人信息。
- **管理员（可选，后续）**：管理用户、文章内容审核/下架（MVP 先不强制实现审核流）。

权限规则（MVP）：
- 草稿仅作者可见
- 已发布文章所有人可见
- 编辑/删除仅作者可操作

## 4. 功能范围（MVP）

### 4.1 账号与认证
- 注册：用户名/邮箱（二选一可简化为用户名）+ 密码
- 登录：用户名 + 密码
- 退出登录
- 密码找回：**MVP 可不做**（后续可接邮箱）

验收要点：
- 密码存储必须为不可逆哈希（BCrypt）
- 登录成功后前端可持久化会话（JWT 或 Session；建议 JWT）

### 4.2 文章
- 创建文章（草稿状态）：标题、摘要（可自动截取）、正文（Markdown）
- 编辑文章：仅作者
- 发布/取消发布：改变状态
- 删除文章：软删除或硬删除（MVP 建议软删除）
- 文章列表：按时间倒序分页
- 文章详情：展示 Markdown 渲染后的内容

验收要点：
- 草稿不会出现在公开列表
- 文章列表/详情可在不登录情况下访问

### 4.3 分类与标签
- 分类：文章可选 1 个分类（MVP 简化）
- 标签：文章可选多个标签
- 列表页支持按分类/标签筛选：**MVP 可先做按分类或标签其一**（推荐先做标签）

### 4.4 搜索
- 关键字搜索文章：按标题/摘要（MVP）
- 结果分页

说明：MVP 采用数据库 `LIKE` 搜索即可，后续可接入 ES。

### 4.5 个人主页（作者页）
- 展示作者信息（昵称/简介/头像）
- 展示该作者已发布文章列表

### 4.6 评论（可选，建议作为 Phase 2）
- 访客/登录用户评论：**建议 MVP 先仅支持登录用户评论**
- 评论列表：按时间
- 删除评论：作者或管理员

## 5. 非功能需求

### 5.1 安全
- 认证：JWT（Access Token）
- 密码：BCrypt
- 接口校验：参数校验（JSR-380）
- 基础防护：
  - 文章 Markdown 渲染时进行 XSS 防护（前端渲染时开启安全模式或后端过滤）
  - 防止越权：所有写操作校验 `authorId == currentUserId`

### 5.2 性能与容量（MVP 指标）
- 文章列表分页查询，默认每页 10/20
- 单机部署可支持 1k~10k 篇文章量级的基础访问

### 5.3 可用性
- 前端路由清晰：列表/详情/写作台/个人页
- 错误提示明确：登录失败、无权限、参数错误等

### 5.4 可维护性
- 后端采用分层结构（Controller/Service/Repository/Mapper）
- 统一响应格式与异常处理
- 数据库表结构可演进（保留 `created_at/updated_at/deleted_at`）

## 6. 里程碑（建议）
- **M1（MVP）**：注册登录 + 文章 CRUD（草稿/发布）+ 列表/详情 + 标签 + 搜索
- **M2**：评论 + 管理端（简化）+ 文章置顶/推荐
- **M3**：全文检索（ES）+ 关注/收藏/点赞 + 通知

## 7. 典型用户故事
- 作为访客，我可以浏览最新文章列表并查看文章详情。
- 作为用户，我可以创建草稿并多次编辑，最终发布。
- 作为用户，我可以在个人主页查看我已发布的文章。
- 作为用户，我可以通过关键字搜索文章标题。

## 8. 验收清单（MVP）
- 注册登录可用，密码为 BCrypt 哈希存储
- 未登录可浏览公开文章列表/详情
- 登录后可创建/编辑/发布/删除自己的文章
- 草稿不可被他人访问
- 标签与搜索功能可用
